# 🏗️ インフラストラクチャ変更 Pull Request

## 📋 インフラ変更概要
<!-- このPRで行うインフラ変更について簡潔に説明してください -->

## 🎯 変更目的
<!-- なぜこのインフラ変更が必要なのかを説明 -->
- [ ] パフォーマンス改善
- [ ] コスト最適化
- [ ] セキュリティ強化
- [ ] 可用性向上
- [ ] スケーラビリティ向上
- [ ] コンプライアンス対応
- [ ] その他: ___________

## 📊 変更サマリー
| 項目 | 変更前 | 変更後 | 影響 |
|------|--------|--------|------|
| リソース数 | X個 | Y個 | +Z個 |
| 月額コスト概算 | $XX | $YY | ±$ZZ |
| 可用性 | XX% | YY% | +Z% |

## 🔧 技術的変更詳細

### 新規追加リソース
- [ ] **VPC関連**
  - [ ] VPC
  - [ ] サブネット
  - [ ] ルートテーブル
  - [ ] インターネットゲートウェイ
  - [ ] NATゲートウェイ
  - [ ] VPCエンドポイント

- [ ] **コンピューティング**
  - [ ] EC2インスタンス
  - [ ] Auto Scaling Group
  - [ ] Launch Template
  - [ ] ECS/Fargate

- [ ] **ロードバランサー**
  - [ ] Application Load Balancer
  - [ ] Network Load Balancer
  - [ ] ターゲットグループ
  - [ ] リスナー

- [ ] **セキュリティ**
  - [ ] セキュリティグループ
  - [ ] NACL
  - [ ] IAMロール
  - [ ] IAMポリシー

- [ ] **ストレージ・データベース**
  - [ ] S3バケット
  - [ ] RDS
  - [ ] ElastiCache
  - [ ] EBS

- [ ] **その他**
  - [ ] CloudWatch
  - [ ] Route53
  - [ ] その他: ___________

### 変更されるリソース
- [ ] **設定変更**
  - [ ] インスタンスタイプ変更
  - [ ] セキュリティグループルール変更
  - [ ] スケーリング設定変更

- [ ] **アップグレード**
  - [ ] AMI更新
  - [ ] ソフトウェアバージョン更新

### 削除されるリソース
- [ ] 不要リソースの削除
- [ ] 重複リソースの統合
- [ ] その他: ___________

## 🚨 破壊的変更・リスク評価
### 破壊的変更
- [ ] **破壊的変更なし**
- [ ] **リソース再作成が必要**
  - 対象リソース: ___________
  - 予想ダウンタイム: ___________
- [ ] **データ損失の可能性**
  - 対象データ: ___________
  - バックアップ対策: ___________
- [ ] **既存接続への影響**
  - 影響範囲: ___________
  - 対策: ___________

### リスク軽減策
- [ ] バックアップ取得済み
- [ ] ロールバック手順準備済み
- [ ] 段階的デプロイ計画
- [ ] 監視・アラート設定
- [ ] その他: ___________

## 📋 デプロイ計画
### デプロイ手順
1. [ ] **事前準備**
   - [ ] バックアップ取得
   - [ ] 関係者への通知
   - [ ] メンテナンス時間の確保

2. [ ] **デプロイ実行**
   - [ ] `terraform plan` で変更内容確認
   - [ ] ステージング環境での検証
   - [ ] `terraform apply` 実行
   - [ ] 段階的リリース（必要に応じて）

3. [ ] **事後確認**
   - [ ] 動作確認
   - [ ] 監視メトリクス確認
   - [ ] ログ確認

### ロールバック計画
- [ ] ロールバック手順書作成済み
- [ ] ロールバック実行時間: ___________
- [ ] ロールバック判断基準明確化

## 🧪 テスト・検証結果
```bash
# terraform plan の結果
Plan: X to add, Y to change, Z to destroy.

# 主要な変更内容
+ aws_xxx.new_resource
~ aws_yyy.existing_resource
- aws_zzz.old_resource
```

### 検証項目
- [ ] **機能検証**
  - [ ] 新機能が正常動作
  - [ ] 既存機能に影響なし
  - [ ] パフォーマンス要件満足

- [ ] **セキュリティ検証**
  - [ ] セキュリティグループ設定適切
  - [ ] IAM権限最小限
  - [ ] 暗号化設定適切

- [ ] **運用検証**
  - [ ] 監視設定適切
  - [ ] ログ出力適切
  - [ ] バックアップ設定適切

## 💰 コスト影響分析
### 月額コスト変化
- **EC2**: $XX → $YY (±$ZZ)
- **ストレージ**: $XX → $YY (±$ZZ)
- **ネットワーク**: $XX → $YY (±$ZZ)
- **その他**: $XX → $YY (±$ZZ)
- **合計**: $XX → $YY (±$ZZ)

### コスト最適化施策
- [ ] リザーブドインスタンス活用
- [ ] スポットインスタンス活用
- [ ] 不要リソース削除
- [ ] その他: ___________

## 📝 品質確認
- [ ] `terraform fmt` 実行済み
- [ ] `terraform validate` 実行済み
- [ ] `terraform plan` でエラーなし
- [ ] セキュリティベストプラクティス準拠
- [ ] 運用ドキュメント更新済み
- [ ] 監視・アラート設定済み

## 📖 関連資料
- 関連Issue: Closes #XXX
- 設計資料: [リンク]
- 運用手順書: [リンク]
- 参考資料: [リンク]

## 👥 承認・レビュー
### 必要な承認
- [ ] インフラチームレビュー
- [ ] セキュリティチームレビュー
- [ ] 運用チームレビュー
- [ ] プロダクトオーナー承認

### レビュー観点
- [ ] アーキテクチャ設計の妥当性
- [ ] セキュリティ要件の充足
- [ ] 運用・保守性の考慮
- [ ] コスト効率性

## 🔄 今後の計画
### 短期計画 (1-2週間)
- [ ] 監視メトリクス分析
- [ ] パフォーマンス最適化
- [ ] その他: ___________

### 中長期計画 (1-3ヶ月)
- [ ] さらなる最適化
- [ ] 関連機能の追加
- [ ] その他: ___________

## 💬 補足事項
<!-- その他、レビュアーに伝えたいことがあれば記載 -->

---

## ⚠️ 重要な確認事項
- **本番環境への影響を十分に検討しましたか？**
- **ダウンタイムが発生する場合、関係者への通知は完了していますか？**
- **ロールバック手順は準備できていますか？**